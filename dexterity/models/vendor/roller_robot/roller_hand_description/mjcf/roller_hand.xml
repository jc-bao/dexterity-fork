<mujoco>
  <compiler angle="radian" coordinate="local" meshdir="../meshes" texturedir="../textures" />

  <visual>
    <quality shadowsize="4096" />
  </visual>

  <size njmax="500" nconmax="200" />

  <asset>
    <mesh name="roller" file="roller.stl" scale="1 1 1" />
    <mesh name="cube" file="cube.stl" scale="1 1 1" />
    <mesh name="cube2" file="cube2.stl" scale="1 1 1" />
    <mesh name="rectangle" file="rectangle.stl" scale="1 1 1" />
    <mesh name="rectangle2" file="rectangle2.stl" scale="1 1 1" />
    <texture builtin="none" name="cube_tex" height="32" width="32" rgb1="1 1 1" type="cube" file="wood.png"></texture>
    <material name="cube" texture="cube_tex" />
    <texture builtin="none" name="rubik_tex" height="32" width="32" rgb1="1 1 1" type="cube" file="rubik.png"></texture>
    <material name="rubik" texture="rubik_tex" />
  </asset>

  <default>
    <mesh scale="0.001 0.001 0.001" />
    <joint limited="true" damping="0.1" armature="0.005" margin="0.0" frictionloss="0.1" />
    <general ctrllimited="true" ctrlrange="-1 1" />
    <default class="visual">
      <geom contype="0" conaffinity="0" group="0" />
    </default>
    <default class="collision">
      <geom group="3" />
    </default>
  </default>

  <worldbody>
    <body name="forearm" pos="0 0 0.026625">
      <geom mass="0.1" pos="0 0 0" rgba="0.855 0.267 0.314 1" size="0.0375 0.026625" type="cylinder" />
      <!-- <body name="crossbar" pos="0 0 0.02"> -->
      <geom name="crossbar" mass="0.01" size="0.005 0.1 0.005" rgba="0.063 0.522 0.737 1" type="box" />
      <!-- </body> -->

      <!-- Left -->
      <body name="l1" pos="0.0 -0.08 0.073525">
        <joint axis="0 1 0" damping="0.1" name="finger_l" pos="0.0 0.05 -0.043525" type="slide" range="-0.02 0.02" />
        <geom name="l1" mass="0.01" size="0.005 0.005 0.06" rgba="0.063 0.522 0.737 1" type="box" />
        <site name="sl" pos="0 0 0"/>
        <body name="l2" pos="0.0 0.0184 0.043525">
          <joint axis="0 1 0" damping="0.5" name="pitch_l" pos="0.0 -0.0184 0" type="hinge" range="-1.57 1.57" />
          <geom name="l2" mass="0.01" size="0.005 0.0184 0.005" rgba="0.063 0.522 0.737 1" type="box" />
          <body name="l3" pos="0.0 0.0184 0.0">
            <joint axis="0 0 1" damping="0.1" range="-1000000 1000000" name="roll_l" pos="0.0 0 0" type="hinge" />
            <geom name="l3" mass="0.01" type="mesh" mesh="roller" rgba="0.973 0.741 0.498 0.7" />
            <body name="l3_visual_aid_top" pos="0 0 -0.025">
              <geom name="l3_visual_aid_top" mass="0" type="box" size="0.005 0.015 0.005" rgba="0.855 0.267 0.314 1" />
            </body>
            <body name="l3_visual_aid_bottom" pos="0 0 0.025">
              <geom name="l3_visual_aid_bottom" mass="0" type="box" size="0.005 0.015 0.005" rgba="0.063 0.522 0.737 1" />
            </body>
          </body>
        </body>
      </body>

      <!-- Right -->
      <body name="r1" pos="0.0 0.08 0.073525">
        <joint axis="0 -1 0" damping="0.1" name="finger_r" pos="0.0 -0.05 -0.043525" type="slide" range="-0.02 0.02" />
        <geom name="r1" mass="0.01" size="0.005 0.005 0.06" rgba="0.063 0.522 0.737 1" type="box" />
        <site name="sr" pos="0 0 0"/>
        <body name="r2" pos="0.0 -0.0184 0.043525">
          <joint axis="0 1 0" damping="0.5" name="pitch_r" pos="0.0 -0.0184 0" type="hinge" range="-1.57 1.57" />
          <geom name="r2" mass="0.01" size="0.005 0.0184 0.005" rgba="0.063 0.522 0.737 1" type="box" />
          <body name="r3" pos="0.0 -0.0184 0.0">
            <joint axis="0 0 1" damping="0.1" name="roll_r" pos="0.0 0 0" range="-1000000 1000000" type="hinge" />
            <geom name="r3" mass="0.01" type="mesh" mesh="roller" rgba="0.973 0.741 0.498 0.7" />
            <body name="r3_visual_aid_top" pos="0 0 -0.025">
              <geom name="r3_visual_aid_top" mass="0" type="box" size="0.005 0.015 0.005" rgba="0.855 0.267 0.314 1" />
            </body>
            <body name="r3_visual_aid_bottom" pos="0 0 0.025">
              <geom name="r3_visual_aid_bottom" mass="0" type="box" size="0.005 0.015 0.005" rgba="0.063 0.522 0.737 1" />
            </body>
          </body>
        </body>
      </body>
    </body>

  </worldbody>

  <actuator>
    <!-- <position name="motor_pitch_l" joint="pitch_l" kp="20" ctrlrange="-3.15 3.15"/> -->
    <velocity name="motor_pitch_l" joint="pitch_l" ctrlrange="-4 4"/>
    <velocity name="motor_roll_l" joint="roll_l" ctrlrange="-4 4"/>

    <!-- <position name="motor_pitch_r" joint="pitch_r" kp="20" ctrlrange="-3.15 3.15"/> -->
    <velocity name="motor_pitch_r" joint="pitch_r" ctrlrange="-4 4"/>
    <velocity name="motor_roll_r" joint="roll_r" ctrlrange="-4 4"/>
  </actuator>

  <contact>
    <exclude body1="l1" body2="l2" />
    <exclude body1="l2" body2="l3" />

    <exclude body1="l3" body2="l3_visual_aid_top" />
    <exclude body1="l3" body2="l3_visual_aid_bottom" />

    <exclude body1="r1" body2="r2" />
    <exclude body1="r2" body2="r3" />

    <exclude body1="r3" body2="r3_visual_aid_top" />
    <exclude body1="r3" body2="r3_visual_aid_bottom" />

  </contact>

  <tendon>
    <spatial width="0.002" rgba=".95 .3 .3 1" springlength="0.00" damping="0.01" stiffness="1">
      <site site="sl"/>
      <site site="sr"/>
    </spatial> 
  </tendon>
</mujoco>